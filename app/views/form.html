<!-- form.html -->
<div>
  <div>
    <div id="form-container">
      <div class="page-header text-center">
        <!-- the links to our nested states using relative paths -->
        <!-- add the active class if the state matches our ui-sref -->
        <div id="status-buttons" class="text-center">
          <a ui-sref=".help"><span>?</span>Help</a>
          <a style="visibility:hidden;"><span>?</span>place</a>
          <a href="#/form/" id="prev" class="pN"><span><<</span>Previous</a>
          <a ui-sref-active="active" ui-sref=".type"><span>1</span>Type</a>
          <a ui-sref-active="active" ui-sref=".members"><span>2</span> Members</a>
          <a ui-sref-active="active" ui-sref=".summary"><span>3</span>Summary</a>
          <a ui-sref-active="active" ui-sref=".requirements"><span>4</span>Requirements</a>
          <a ui-sref-active="active" ui-sref=".deliverables"><span>5</span>Deliverables</a>
          <a ui-sref-active="active" ui-sref=".review"><span>6</span>Review</a>
          <a href="#/form/" id="next" class="pN"><span>>></span> Next</a>
          <a style="visibility:hidden;"><span>?</span>place</a>
          <a href="#/form/final" id="final" class="finalN disabled" style="visibility:hidden;"><span>âœ“</span> Submit</a>
        </div>
      </div>

      <!-- use ng-submit to catch the form submission and use our Angular function -->
      <form id="signup-form" ng-submit="processForm()">
        <div class="leftSide" style="visibility:hidden">
          <!-- placeholder  -->
          placeholder
        </div>

        <!-- our nested state views will be injected here -->
        <div id="form-views" ui-view>
        </div>

        <div class="rightSide" id="rightSide">
          <div id="bubble" class="bubble">
          </div>
        </div>
      </form>
    </div>
  </div>
</div>


<pre>
  {{ record | json }}
</pre>
<!-- For tests
-->

<script>
function changeURL(id,value){
  var doc = document.getElementById(id)
  doc.href = '#/form/'+value;
  if(value == '' || value == null || value == undefined ){
    doc.style = 'visibility:hidden';
  } else {
    doc.style = 'visibility:visible';
  }

}
function updateLinks(prev,next){
  resetBubble();
  changeURL('prev',prev);
  changeURL('next',next);
}

function getParam(elem,type){
  var name = elem.id;
  var show = 0;
  angular.forEach($scope.fields,function(elem){
    if( elem.name == name ){
      show = elem[type];
  }
  })
  return show;
}

function setSettings(elem){
  var name = elem.id;
  var level = 0;
  switch($scope.record.projectType) {
    case 'gold':
    level = 2;
    break;
    case 'silver':
    level = 1;
    break;
    case 'bronze':
    level = 0;
    break;
    default:
    level = 0;
  }
  var req = 0;
  var show = 0;
  angular.forEach($scope.fields,function(elem){
    if( elem.name == name ){
      req = elem.required;
      show = elem.show;
  }
})
  if(show < level){
    elem.display = 'none';
  }

  if(req >= level){
    elem.required = true;
  }
}
</script>
